<h1><%= t('view.my_daily_record') %></h1>

<table>
  <thead>
    <tr>
      <th><%= t('activerecord.attributes.food.name') %></th>
      <th><%= t('activerecord.attributes.food.protein') %></th>
      <th><%= t('activerecord.attributes.food.quantity') %></th>
      <th><%= t('activerecord.attributes.food.unit') %></th>
      <th><%= t('activerecord.attributes.record.ate') %></th>
      <th><%= t('activerecord.attributes.record.record_on') %></th>
    </tr>
  </thead>

  <tbody>
    <% if @records != nil %>
      <% date = "" %>
      <% protain_amount = 0 %>
      <% @records.each do |record| %>
        <% food = Food.find(record.food_id) %>
        <% protain_amount += (food.protain * record.ate) %>
        <% before_day = date if record != @records.first %>
        <% date = record.record_on %>
        <tr>
          <td><%= food.name %></td>
          <td><%= food.protain %></td>
          <td><%= food.quantity %></td>
          <td><%= food.unit %></td>
          <td><%= record.ate %></td>
          <td><%= record.record_on %></td>
          <td><%= link_to t('view.show'), record_path(record.id) %></td>
          <td><%= link_to t('view.edit'), edit_record_path(record.id) %></td>
          <td><%= link_to t('view.destroy'), record_path(record.id), method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
        <% if date != before_day %>
          <tr>
            <%= "#{date}"%><%= t('view.my_daily_amount_protein') %><%= protain_amount %><%= "g" %>
            <% protain_amount = 0 %>
          </tr>
        <% end %>
      <% end %>
    <% end %>
  </tbody>
</table>
